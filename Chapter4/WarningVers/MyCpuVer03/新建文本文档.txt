重新整理代码，但还是存在时序不正确的情况。